<!DOCTYPE html>
<head>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <title>CodeTestPython</title>
</head>
<link rel="stylesheet" href="/static/css/sample.css">
<html lang="ja">
    <h1>Pythonコード　計算量可視化ツール</h1>
    <label><input type="checkbox" name="HTMLoutput" value="実行状況" onchange="HTMLoutput();">実行状況</label>
    <label><input type="checkbox" name="HTMLoutput" value="出力結果" onchange="HTMLoutput();">出力結果</label>
    <label><input type="checkbox" name="HTMLoutput" value="コード" checked onchange="HTMLoutput();">コード</label>
    <div id = "HTML_実行状況">
        <h2>実行状況</h2>
        <div>{{ message_result }}</div>
    </div>
    
    <div id = "HTML_出力結果">
    <h1>出力結果</h1>
        {% for line in message_answer %}
        <div>{{ line }}</div>
        {% endfor %}
    </div>

    <div class = "boxes" id = "HTML_コード">
        <div class="box red">
            <h2>コード</h2>
            <label><input type="radio" name="Code_ferture" value="実行時間" onchange="HTMLoutput();">実行時間</label>
            <label><input type="radio" name="Code_ferture" value="出現回数" onchange="HTMLoutput();">出現回数</label>
            <label><input type="radio" name="Code_ferture" value="一回当たりの実行時間" checked onchange="HTMLoutput();">一回当たりの実行時間</label>
            <label><input type="radio" name="Code_ferture" value="修正後" checked onchange="HTMLoutput();">修正後のコード(デバック用)</label>
            <div id = "コード_実行時間">
            コード_実行時間
            {% for line in message_codecolor.time_sum_color %}
            <div style = "{{line}}"><span>{{message_codecolor.time_sum[loop.index0]}}</span>{{ message_code.OringinalCode[loop.index0] }}</div>
            {% endfor %}
            </div>
            <div id = "コード_出現回数">
            コード_出現回数
            {% for line in message_codecolor.count_sum_color %}
            <div style = "{{line}}"><span>{{message_codecolor.count_sum[loop.index0]}}</span>{{ message_code.OringinalCode[loop.index0] }}</div>
            {% endfor %}
            </div>
            <div id = "コード_一回当たりの実行時間">
            コード_一回当たりの実行時間
            {% for line in message_codecolor.time_per_count_color %}
            <div style = "{{line}}"><span>{{message_codecolor.time_per_count[loop.index0]}}</span>{{ message_code.OringinalCode[loop.index0] }}</div>
            {% endfor %}
            </div>
            <div id = "コード_修正後">
            コード_一回当たりの実行時間
            {% for line in message_code.RemakeCode %}
            <div><span>{{loop.index0+1}}</span>{{ message_code.RemakeCode[loop.index0] }}</div>
            {% endfor %}
            </div>
        </div>
        <div class="box blue">
            pass
        </div>
    </div>

    <form action = "/codetest" method = "POST">
    <label><h2>Code:<br></h2>
        <textarea id = "inputcode" name = "inputcode" rows="10" cols="50" wrap="off">{{save['inputcode']}}</textarea><br>
    </label>
    <label ><h2>TestCase:</h2><br>
        <textarea id = "testcase" name = "testcase" rows="3" cols="50" wrap="off">{{save['testcase']}}</textarea><br>
    </label>
    <label>    
        <input type="submit" value="Run"><br>
    </label>
    <label>
        <input id="colsSlider" name = "colsSlider" type="range" value="{{save["cols"]}}" min="10" max="100" step="2" onchange="reshape();">列の横幅</input>
    </label><br>
    <label>
        <input id="rowSlider" name="rowSlider" type="range" value="{{save["row"]}}" min="5" max="50" step="1" onchange="reshape();">列数</input>
    </label><br>
</form>
</html>

<script>
    // コードを入力する部分のサイズを変更する
    function reshape() {
        element_cols = document.getElementById('colsSlider');
        element_row = document.getElementById('rowSlider');
        target = document.getElementById("inputcode");  
        target.cols = element_cols.value;
        target.rows = element_row.value;
    }
    reshape()

    function HTMLoutput(){
        const x = document.getElementsByName("HTMLoutput");
        for(let i = 0; i < x.length; ++i){
            const element = document.getElementById("HTML_"+x[i].value);
            if (x[i].checked){
                element.style.display = "block"
            }else{
                element.style.display = "none"
            }
        }
        const y = document.getElementsByName("Code_ferture");
        for(let i = 0; i < y.length; ++i){
            const element = document.getElementById("コード_"+y[i].value);
            if (y[i].checked){
                element.style.display = "block"
            }else{
                element.style.display = "none"
            }
        }
    }
    HTMLoutput()
</script>